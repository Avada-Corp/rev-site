# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫

## –û–±–∑–æ—Ä

–í —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫ –≤ —Å—Ü–µ–Ω–∞—Ö –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞—Ö. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–∏–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞–∂–∏–º–∞—é—Ç –∏ –æ—Ç–∫—É–¥–∞ –æ–Ω–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç.

## –ù–æ–≤—ã–π —Ç–∏–ø –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–∏–ø `BUTTON_CLICK` –≤ enum `InteractionType`:

```typescript
enum InteractionType {
  SCENE_VIEW = 'scene_view',
  REMINDER_SENT = 'reminder_sent',
  REMINDER_READ = 'reminder_read',
  BUTTON_CLICK = 'button_click', // –ù–û–í–´–ô
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫

–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –∑–∞–ø–∏—Å–∏ —Å —Ç–∏–ø–æ–º `BUTTON_CLICK` —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–∫–∞–∫ –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤):
- `chatId` (number) - ID —á–∞—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `username` (string, optional) - Username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `type` (InteractionType) - –í—Å–µ–≥–¥–∞ `'button_click'`
- `clickedAt` (Date) - –í—Ä–µ–º—è –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏
- `createdAt` (Date) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updatedAt` (Date) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫:
- `buttonId` (string, optional) - ID –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏ (—ç—Ç–æ `targetSceneId` –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑ —Å—Ü–µ–Ω –∏–ª–∏ `action` –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫)
- `buttonText` (string, optional) - –¢–µ–∫—Å—Ç –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏
- `sourceSceneId` (string, optional) - **–í–∞–∂–Ω–æ**: –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞:
  - **–î–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑ —Å—Ü–µ–Ω**: ID —Å—Ü–µ–Ω—ã, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞
  - **–î–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫**: ID —Å—Ü–µ–Ω—ã, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏—à–ª–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞
- `reminderTimer` (number, optional) - –¢–∞–π–º–µ—Ä –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫)

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –Ω–∞–∂–∞—Ç–∏—è

### –ö–Ω–æ–ø–∫–∞ –∏–∑ —Å—Ü–µ–Ω—ã
–ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –≤ —Å—Ü–µ–Ω–µ (welcomeButtons), —Ç–æ:
- `sourceSceneId` –∑–∞–ø–æ–ª–Ω–µ–Ω - —ç—Ç–æ ID —Å—Ü–µ–Ω—ã, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–∂–∞–ª–∏
- `reminderTimer` = `undefined` –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "type": "button_click",
  "buttonId": "a1",
  "buttonText": "üîç –£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ",
  "sourceSceneId": "start",
  "reminderTimer": null,
  "clickedAt": "2024-01-15T10:30:00Z"
}
```

### –ö–Ω–æ–ø–∫–∞ –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏
–ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –≤ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–µ, —Ç–æ:
- `sourceSceneId` –∑–∞–ø–æ–ª–Ω–µ–Ω - —ç—Ç–æ ID —Å—Ü–µ–Ω—ã, –æ—Ç –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏—à–ª–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞
- `reminderTimer` –∑–∞–ø–æ–ª–Ω–µ–Ω - —ç—Ç–æ —Ç–∞–π–º–µ—Ä –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö

**–ü—Ä–∏–º–µ—Ä:**
```json
{
  "type": "button_click",
  "buttonId": "a1",
  "buttonText": "üîç –£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ",
  "sourceSceneId": "start",
  "reminderTimer": 300000,
  "clickedAt": "2024-01-15T11:00:00Z"
}
```

## –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏

–î–ª—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏:
- `sourceSceneId` + `reminderTimer`

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–ª–∏—á–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏ –æ—Ç –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Å—Ü–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞ —á–µ—Ä–µ–∑ 1 —á–∞—Å –æ—Ç —Å—Ü–µ–Ω—ã `start`).

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫
```typescript
const buttonClicks = interactions.filter(
  interaction => interaction.type === 'button_click'
);
```

### –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫ –∏–∑ —Å—Ü–µ–Ω
```typescript
const sceneButtonClicks = interactions.filter(
  interaction => 
    interaction.type === 'button_click' && 
    !interaction.reminderTimer
);
```

### –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫
```typescript
const reminderButtonClicks = interactions.filter(
  interaction => 
    interaction.type === 'button_click' && 
    interaction.reminderTimer !== undefined &&
    interaction.reminderTimer !== null
);
```

### –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–Ω–æ–ø–∫–∏
```typescript
const specificButtonClicks = interactions.filter(
  interaction => 
    interaction.type === 'button_click' && 
    interaction.buttonId === 'a1'
);
```

### –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ü–µ–Ω—ã
```typescript
const clicksFromScene = interactions.filter(
  interaction => 
    interaction.type === 'button_click' && 
    interaction.sourceSceneId === 'start'
);
```

### –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏
```typescript
const clicksFromReminder = interactions.filter(
  interaction => 
    interaction.type === 'button_click' && 
    interaction.sourceSceneId === 'start' &&
    interaction.reminderTimer === 300000 // 5 –º–∏–Ω—É—Ç
);
```

## –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–∞–º
–ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
- –ö–∞–∫–∏–µ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∂–∏–º–∞—é—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ
- –ò–∑ –∫–∞–∫–∏—Ö —Å—Ü–µ–Ω —á–∞—â–µ –Ω–∞–∂–∏–º–∞—é—Ç –∫–Ω–æ–ø–∫–∏
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫ (—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞–∂–∞–ª–∏ –∫–Ω–æ–ø–∫—É –∏–∑ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–ª–æ–∫ –æ—Ç –æ–¥–Ω–æ–π —Å—Ü–µ–Ω—ã

### –ü—Ä–∏–º–µ—Ä –ø–æ–¥—Å—á–µ—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```typescript
// –ü–æ–¥—Å—á–µ—Ç –Ω–∞–∂–∞—Ç–∏–π –ø–æ –∫–Ω–æ–ø–∫–∞–º
const buttonStats = buttonClicks.reduce((acc, click) => {
  const key = click.buttonId;
  if (!acc[key]) {
    acc[key] = {
      buttonId: key,
      buttonText: click.buttonText,
      totalClicks: 0,
      fromScenes: 0,
      fromReminders: 0
    };
  }
  acc[key].totalClicks++;
  if (click.reminderTimer) {
    acc[key].fromReminders++;
  } else {
    acc[key].fromScenes++;
  }
  return acc;
}, {});
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π**: `sourceSceneId` –≤—Å–µ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω –¥–ª—è –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫, –Ω–æ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (—Å—Ü–µ–Ω–∞ –∏–ª–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞)

2. **reminderTimer**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ `undefined` –∏–ª–∏ `null` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –∞ –Ω–µ –Ω–∞ `0`, —Ç–∞–∫ –∫–∞–∫ —Ç–∞–π–º–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º —á–∏—Å–ª–æ–º

3. **buttonText**: –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–≤–µ–Ω `buttonId`, –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –∏–∑ —Å—Ü–µ–Ω—ã/–Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∏

4. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏**: `clickedAt` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

5. **–°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∏–ø–∞–º–∏**: –ù–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –ø–æ —Å—Ü–µ–Ω–∞–º (`SCENE_VIEW`), –Ω–æ –º–æ–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ `sourceSceneId` –∏ `buttonId`

